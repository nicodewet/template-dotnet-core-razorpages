# template-dotnet-core-razorpages
Template .NET Core 3.1 solution broken down into three projects: services layer, services layer unit tests and a simple ASP.NET Core Razor Pages web application.

## Development Environment
Although .NET Core has a cross-platform runtime, as per the platform specific tabs in docs.microsoft.com the local development enviroment setup that was used is as follows:

* macOS Catalina 10.15.5
* .NET Core SDK version 3.1.403
* Visual Studio Code 1.50.1 with extension C# for Visual Studio Code (powered by OmniSharp) 1.23.4
* [.NET Core CLI](https://docs.microsoft.com/en-us/dotnet/core/tools/)

Note we have expressly not leveraged [docker images for ASP.NET Core](https://docs.microsoft.com/en-us/aspnet/core/host-and-deploy/docker/building-net-docker-images?view=aspnetcore-3.1) and [containerisation](https://docs.microsoft.com/en-us/dotnet/core/docker/build-container?tabs=windows) although this would be a simple exercise. Our scope is localhost based development and execution.

### Installation, Configuration and Execution

If your primary concern as a developer is to get the web application up and running as fast as possible on your local enviroment please complete the following steps:

* [Download and install .NET Core SDK 3.1](https://dotnet.microsoft.com/download)
* Clone this git repository
* Navigate to the repository directory from a command line terminal and execute: dotnet run --project webApp

Example of running up the webApp:

```bash
nico@Nicos-Air template-dotnet-core-razorpages % dotnet run --project webApp
info: Microsoft.Hosting.Lifetime[0]
      Now listening on: http://localhost:5000
info: Microsoft.Hosting.Lifetime[0]
      Application started. Press Ctrl+C to shut down.
info: Microsoft.Hosting.Lifetime[0]
      Hosting environment: Development
info: Microsoft.Hosting.Lifetime[0]
      Content root path: /Users/nico/git/DOTNET/template-dotnet-core-razorpages/webApp
```

## Contrived Requirements

As an exercise we will develop a working web application in C# consisting of two or more web pages that perform the following function:

* Capture a person's name and a number.
* Convert this number into words with a currency of dollars and cents.
* Render this name and number (as words) as a web page.
* As an example, John Doe and "123.45" should render as output John Doe and "ONE HUNDRED AND TWENTY-THREE DOLLARS AND FORTY-FIVE CENTS"

## Templating Overview

The _templating_ entails some design constraints and scaffolding steps which as detailed as follows.

### Design Constraints (design and programming techniques utilized):

* We will follow TDD practices and Robert C. Martin's Clean Architecture principles.
* Our unit tests will be in C# and as per the testing pyramid this is the foundation of our testing efforts (we will intially park integration testing).
* We will embrace Razor Pages' [DRY ("Don't Repeat Yourself") principle support pertaining to validation logic](https://docs.microsoft.com/en-us/aspnet/core/tutorials/razor-pages/validation?view=aspnetcore-3.1&tabs=visual-studio).

### Scaffolding Steps:

* Generate an authoritative .gitignore file using _dotnet new gitignore_.
* Get the solution and projects set up correctly using reproducible steps. This is similar to a 
multi-module Maven build. 
* Leverage the approach and solution structure used in [Unit testing C# in .NET Core using dotnet test and xUnit](https://docs.microsoft.com/en-us/dotnet/core/testing/unit-testing-with-dotnet-test).
* Document the solution and project level build and run steps.
* Wire the services layer into the ASP.NET Razor Pages web application. Here we are leveraging [ASP.NET Core's support for the dependency injection (DI) software design pattern](https://docs.microsoft.com/en-us/aspnet/core/fundamentals/dependency-injection?view=aspnetcore-3.1).
* Leverage the _dotnet new webApp_ command to generate a [working base web application](https://dotnet.microsoft.com/learn/aspnet/hello-world-tutorial/create).
* Leverage Razor Pages styling and design as generated by [aspnet-codegenerator](https://docs.microsoft.com/en-us/aspnet/core/fundamentals/tools/dotnet-aspnet-codegenerator?view=aspnetcore-3.1) and used in reference [ASP.NET Core documentation](https://docs.microsoft.com/en-us/aspnet/core/tutorials/razor-pages/razor-pages-start?view=aspnetcore-3.1&tabs=visual-studio-code).

## Templating Implementation - Step by Step

Here we list the steps required to get our solution structure set up from an empty git repository say with only a README.md file.

### Phase 1 - Services Layer (Class Library Setup)

Create a top level Solution File.

```bash
template-dotnet-core-razorpages % dotnet new sln
```

Create a Class Library. This will result in a [dotnet restore](https://docs.microsoft.com/en-us/dotnet/core/tools/dotnet-restore) in the new project.

```bash
template-dotnet-core-razorpages % dotnet new classlib -o CurrencyWordsService
```

```bash
template-dotnet-core-razorpages % mv CurrencyWordsService/Class1.cs CurrencyWordsService/CurrencyWordsService.cs
```

```bash
template-dotnet-core-razorpages % dotnet sln add CurrencyWordsService/CurrencyWordsService.csproj
Project `CurrencyWordsService/CurrencyWordsService.csproj` added to the solution.
```

Create a template xUnit Test Project. This will result in a [dotnet restore](https://docs.microsoft.com/en-us/dotnet/core/tools/dotnet-restore) in the new project.

```bash
template-dotnet-core-razorpages % dotnet new xunit -o CurrencyWordsService.Tests
```

```bash
template-dotnet-core-razorpages % dotnet sln add ./CurrencyWordsService.Tests/CurrencyWordsService.Tests.csproj
Project `CurrencyWordsService.Tests/CurrencyWordsService.Tests.csproj` added to the solution.
```

```bash
template-dotnet-core-razorpages % dotnet add ./CurrencyWordsService.Tests/CurrencyWordsService.Tests.csproj reference CurrencyWordsService/CurrencyWordsService.csproj
```

```bash
template-dotnet-core-razorpages % mv CurrencyWordsService.Tests/UnitTest1.cs CurrencyWordsService.Tests/CurrencyServiceTest.cs
```

```bash
template-dotnet-core-razorpages % touch CurrencyWordsService/ICurrencyWordsService.cs 
```

Now add a single test case and associated implementation and this should pass (at all times of course):

```bash
template-dotnet-core-razorpages % dotnet test
```

### Phase 2 - Razor Pages Setup

```bash
template-dotnet-core-razorpages % dotnet new webApp -o webApp --no-https
```

```bash
template-dotnet-core-razorpages % dotnet sln add ./webApp/webApp.csproj
```

Run the generated web application as sanity check. Open http://localhost:5000 in a browser. 

```bash
dotnet run --project webApp
```

Now wire the services layer into the webApp project.



## Next Steps

Having set up the outline of our solution, from here on we'll focus on C# based TDD in the service layer.